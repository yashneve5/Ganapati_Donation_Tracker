<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Donation - Ganpati Tracker</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-om"></i>
                <span>Ganpati Tracker</span>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item">
                    <a href="donation.html" class="nav-link active">Donate</a>
                </li>
                <li class="nav-item">
                    <a href="expenses.html" class="nav-link">Expenses</a>
                </li>
                <li class="nav-item">
                    <a href="receipts.html" class="nav-link">Receipts</a>
                </li>
                <li class="nav-item">
                    <a href="sanatan.html" class="nav-link">Sanatan</a>
                </li>
                <li class="nav-item">
                    <a href="about-us.html" class="nav-link">About Us</a>
                </li>
                <li class="nav-item">
                    <a href="contact-us.html" class="nav-link">Contact</a>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <h1><i class="fas fa-hand-holding-heart"></i> Make a Donation</h1>
            <p>Your contribution helps us celebrate Ganpati Utsav with devotion and grandeur</p>
        </div>
    </section>

    <!-- Donation Form Section -->
    <section class="content-section">
        <div class="container">
            <div class="form-container">
                <div class="donation-info">
                    <h2>Why Donate?</h2>
                    <div class="info-grid">
                        <div class="info-item">
                            <i class="fas fa-temple"></i>
                            <h3>Decoration & Setup</h3>
                            <p>Beautiful decorations and mandap setup for Lord Ganpati</p>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-music"></i>
                            <h3>Cultural Programs</h3>
                            <p>Traditional music, dance, and cultural performances</p>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-utensils"></i>
                            <h3>Prasad & Food</h3>
                            <p>Distribution of prasad and community meals</p>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-hands-helping"></i>
                            <h3>Community Service</h3>
                            <p>Supporting local community and charitable activities</p>
                        </div>
                    </div>
                </div>

                <div class="donation-form-section">
                    <h2>Donation Details</h2>
                    <form id="donation-form" class="donation-form" data-validate="donation">
                        <!-- Personal Information Section -->
                        <div class="form-section">
                            <h3 class="section-title">üë§ Personal Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="name">Full Name *</label>
                                    <input type="text" id="name" name="name" required minlength="2" maxlength="100"
                                           pattern="[a-zA-Z\s\.]+" placeholder="e.g., Rajesh Kumar"
                                           title="Only letters, spaces, and dots allowed">
                                    <small class="field-help">Example: Rajesh Kumar, Dr. Priya Sharma</small>
                                </div>
                                <div class="form-group">
                                    <label for="email">Email Address <span class="optional">(Optional)</span></label>
                                    <input type="email" id="email" name="email" maxlength="255"
                                           placeholder="e.g., rajesh@example.com"
                                           title="Valid email format required">
                                    <small class="field-help">Example: rajesh@example.com</small>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="phone">Phone Number <span class="optional">(Optional)</span></label>
                                    <input type="tel" id="phone" name="phone" pattern="[\+]?[\d\s\-\(\)]{10,15}"
                                           placeholder="e.g., +91 98765 43210"
                                           title="10-15 digits with optional country code">
                                    <small class="field-help">Example: +91 98765 43210 or 9876543210</small>
                                </div>
                                <div class="form-group">
                                    <label for="amount">Donation Amount (‚Çπ) *</label>
                                    <input type="number" id="amount" name="amount" min="1" max="1000000" step="1" required
                                           placeholder="e.g., 1001"
                                           title="Amount between ‚Çπ1 and ‚Çπ10,00,000">
                                    <small class="field-help">Example: 1001 (Between ‚Çπ1 - ‚Çπ10,00,000)</small>
                                </div>
                            </div>
                        </div>

                        <!-- Address Information Section -->
                        <div class="form-section">
                            <h3 class="section-title">üè† Address Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="wing">Wing *</label>
                                    <select id="wing" name="wing" required onchange="updateFlatOptions()" title="Select your building wing">
                                        <option value="">Select Wing</option>
                                        <option value="A">Wing A</option>
                                        <option value="B">Wing B</option>
                                        <option value="C">Wing C</option>
                                        <option value="D">Wing D</option>
                                        <option value="E">Wing E</option>
                                    </select>
                                    <small class="field-help">Example: A, B, C, D, or E</small>
                                </div>
                                <div class="form-group">
                                    <label for="floor">Floor *</label>
                                    <select id="floor" name="floor" required onchange="updateFlatOptions()" title="Select your floor">
                                        <option value="">Select Floor</option>
                                        <option value="0">Ground Floor (0)</option>
                                        <option value="1">1st Floor</option>
                                        <option value="2">2nd Floor</option>
                                        <option value="3">3rd Floor</option>
                                        <option value="4">4th Floor</option>
                                        <option value="5">5th Floor</option>
                                        <option value="6">6th Floor</option>
                                        <option value="7">7th Floor</option>
                                        <option value="8">8th Floor</option>
                                        <option value="9">9th Floor</option>
                                        <option value="10">10th Floor</option>
                                    </select>
                                    <small class="field-help">Example: 3 (for 3rd floor)</small>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="flat">Flat Number *</label>
                                    <select id="flat" name="flat" required title="Select your flat number">
                                        <option value="">First select Wing and Floor</option>
                                    </select>
                                    <small class="field-help">Example: 302 (Individual) or 301+302 (Combined)</small>
                                </div>
                                <div class="form-group">
                                    <label for="flatDisplay">Complete Address</label>
                                    <input type="text" id="flatDisplay" name="flatDisplay" readonly
                                           placeholder="Will show: Wing A - 302">
                                    <small class="field-help">Auto-generated from your selections</small>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Information Section -->
                        <div class="form-section">
                            <h3 class="section-title">üí≥ Payment Information</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="paymentMode">Payment Mode *</label>
                                    <select id="paymentMode" name="paymentMode" required title="Select payment method" onchange="showPaymentDetails()">
                                        <option value="">Select Payment Mode</option>
                                        <option value="Cash">üíµ Cash</option>
                                        <option value="UPI">üì± UPI</option>
                                        <option value="Bank Transfer">üè¶ Bank Transfer</option>
                                        <option value="Cheque">üìÑ Cheque</option>
                                        <option value="Online">üíª Online Payment</option>
                                    </select>
                                    <small class="field-help">Example: UPI, Cash, Bank Transfer</small>
                                </div>
                                <div class="form-group">
                                    <label for="date">Donation Date *</label>
                                    <input type="date" id="date" name="date" required max=""
                                           title="Select donation date (cannot be future)">
                                    <small class="field-help">Today's date or any past date</small>
                                </div>
                            </div>
                            
                            <!-- Dynamic Payment Details -->
                            <div id="payment-details" class="payment-details-container" style="display: none;">
                                <!-- Payment details will be populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Additional Information Section -->
                        <div class="form-section">
                            <h3 class="section-title">üìù Additional Information</h3>
                            <div class="form-group">
                                <label for="note">Note/Message <span class="optional">(Optional)</span></label>
                                <textarea id="note" name="note" maxlength="500" rows="3"
                                          placeholder="e.g., Ganpati Bappa Morya! For mandap decoration"></textarea>
                                <small class="field-help">Example: "Ganpati Bappa Morya!" or "For decoration" (Max 500 characters)</small>
                            </div>
                        </div>

                        <div class="quick-amounts">
                            <label>Quick Amount Selection:</label>
                            <div class="amount-buttons">
                                <button type="button" class="amount-btn" onclick="setAmount(51)">‚Çπ51</button>
                                <button type="button" class="amount-btn" onclick="setAmount(101)">‚Çπ101</button>
                                <button type="button" class="amount-btn" onclick="setAmount(501)">‚Çπ501</button>
                                <button type="button" class="amount-btn" onclick="setAmount(1001)">‚Çπ1001</button>
                                <button type="button" class="amount-btn" onclick="setAmount(2001)">‚Çπ2001</button>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-heart"></i> Submit Donation
                            </button>
                            <button type="reset" class="btn btn-secondary">
                                <i class="fas fa-undo"></i> Reset Form
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Payment Information -->
            <div class="payment-info">
                <h2>Payment Information</h2>
                <div class="payment-methods">
                    <div class="payment-method">
                        <h3><i class="fas fa-mobile-alt"></i> UPI Payment</h3>
                        <p><strong>UPI ID:</strong> hiteshsutharvfx@okhdfcbank</p>
                        <p><strong>QR Code:</strong> Scan the QR code for quick payment</p>
                    </div>
                    <div class="payment-method">
                        <h3><i class="fas fa-university"></i> Bank Transfer</h3>
                        <p><strong>Account Name:</strong> Ganpati Utsav Committee</p>
                        <p><strong>Account Number:</strong> 1234567890</p>
                        <p><strong>IFSC Code:</strong> BANK0001234</p>
                        <p><strong>Bank:</strong> State Bank of India</p>
                    </div>
                    <div class="payment-method">
                        <h3><i class="fas fa-money-bill"></i> Cash Payment</h3>
                        <p>Visit our collection center or contact our volunteers</p>
                        <p><strong>Address:</strong> Ganpati Mandal, Main Street</p>
                        <p><strong>Timing:</strong> 9:00 AM - 9:00 PM</p>
                    </div>
                </div>
            </div>

            <!-- Excel Integration Section -->
            <div class="excel-integration-section">
                <h2>Excel Integration</h2>
                <div class="excel-controls">
                    <div class="excel-upload">
                        <label for="excel-file-input" class="btn btn-secondary">
                            <i class="fas fa-upload"></i> Import from Excel
                        </label>
                        <input type="file" id="excel-file-input" accept=".xlsx,.xls" style="display: none;" onchange="importFromExcel(event)">
                    </div>
                    <button onclick="exportToExcel()" class="btn btn-primary">
                        <i class="fas fa-download"></i> Export to Excel
                    </button>
                    <button onclick="downloadExcelTemplate()" class="btn btn-info">
                        <i class="fas fa-file-excel"></i> Download Template
                    </button>
                </div>
                <div class="excel-status" id="excel-status">
                    <p><i class="fas fa-info-circle"></i> Excel integration is active. Donations are saved internally. Click "Export to Excel" to download the complete file.</p>
                </div>
            </div>

            <!-- Live Donations Database -->
            <div class="recent-donations-section">
                <div class="section-header">
                    <h2>Live Donations Database</h2>
                    <div class="section-actions">
                        <button onclick="refreshDonationsTable()" class="btn btn-primary">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                        <button onclick="exportToExcel()" class="btn btn-secondary">
                            <i class="fas fa-download"></i> Export to Excel
                        </button>
                    </div>
                </div>
                
                <!-- Live Donations Table -->
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>S.No.</th>
                                <th>Name</th>
                                <th>Wing & Flat</th>
                                <th>Amount</th>
                                <th>Payment Mode</th>
                                <th>Date</th>
                                <th>Receipt ID</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="donations-table-body">
                            <tr>
                                <td colspan="8" class="text-center">No donations recorded yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div id="recent-donations-list" class="donations-list" style="display: none;">
                    <!-- Recent donations will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3><i class="fas fa-om"></i> Ganpati Tracker</h3>
                    <p>Celebrating Lord Ganpati with devotion, transparency, and community spirit.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="donation.html">Make Donation</a></li>
                        <li><a href="expenses.html">View Expenses</a></li>
                        <li><a href="about-us.html">About Us</a></li>
                        <li><a href="contact-us.html">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact Info</h4>
                    <p><i class="fas fa-envelope"></i> info@ganpatitracker.com</p>
                    <p><i class="fas fa-phone"></i> +91 98765 43210</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Ganpati Tracker. Made with ‚ù§Ô∏è for Lord Ganpati</p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.js"></script>
    <!-- Enhanced JavaScript with Data Management -->
    <script src="js/dataManager.js"></script>
    <script src="js/formValidator.js"></script>
    <script src="js/analyticsEngine.js"></script>
    <script src="js/dataMigration.js"></script>
    <script src="js/donationAPI.js"></script>
    <script src="js/main.js"></script>
    <script>
        // Set today's date as default and max date
        const dateInput = document.getElementById('date');
        const today = new Date().toISOString().split('T')[0];
        dateInput.valueAsDate = new Date();
        dateInput.setAttribute('max', today);
        
        // Set amount function
        function setAmount(amount) {
            document.getElementById('amount').value = amount;
        }
        
        // Update flat options and display address
        function updateFlatOptions() {
            const wing = document.getElementById('wing').value;
            const floor = document.getElementById('floor').value;
            const flatSelect = document.getElementById('flat');
            const flatDisplay = document.getElementById('flatDisplay');
            
            // Clear previous options
            flatSelect.innerHTML = '<option value="">Select Flat Number</option>';
            
            if (wing && floor) {
                // Generate flat numbers based on floor
                const floorNum = floor === '0' ? '0' : floor;
                const flats = [
                    `${floorNum}01`,
                    `${floorNum}02`,
                    `${floorNum}03`,
                    `${floorNum}04`
                ];
                
                // Add individual flat options
                flats.forEach(flatNum => {
                    const option = document.createElement('option');
                    option.value = flatNum;
                    option.textContent = `Flat ${flatNum}`;
                    flatSelect.appendChild(option);
                });
                
                // Add combined flat options
                const combinedOptions = [
                    { value: `${floorNum}01+${floorNum}02`, text: `Flat ${floorNum}01+${floorNum}02 (Combined)` },
                    { value: `${floorNum}02+${floorNum}03`, text: `Flat ${floorNum}02+${floorNum}03 (Combined)` },
                    { value: `${floorNum}03+${floorNum}04`, text: `Flat ${floorNum}03+${floorNum}04 (Combined)` },
                    { value: `${floorNum}01+${floorNum}02+${floorNum}03`, text: `Flat ${floorNum}01+${floorNum}02+${floorNum}03 (Combined)` },
                    { value: `${floorNum}02+${floorNum}03+${floorNum}04`, text: `Flat ${floorNum}02+${floorNum}03+${floorNum}04 (Combined)` },
                    { value: `${floorNum}01+${floorNum}02+${floorNum}03+${floorNum}04`, text: `Entire Floor ${floorNum} (All Flats)` }
                ];
                
                combinedOptions.forEach(combo => {
                    const option = document.createElement('option');
                    option.value = combo.value;
                    option.textContent = combo.text;
                    flatSelect.appendChild(option);
                });
                
                // Update display when flat is selected
                flatSelect.addEventListener('change', function() {
                    if (this.value) {
                        flatDisplay.value = `Wing ${wing} - ${this.value}`;
                    } else {
                        flatDisplay.value = '';
                    }
                });
            }
        }
        
        // Show payment details based on selected payment mode
        function showPaymentDetails() {
            const paymentMode = document.getElementById('paymentMode').value;
            const amount = document.getElementById('amount').value;
            const paymentDetailsContainer = document.getElementById('payment-details');
            
            if (!paymentMode) {
                paymentDetailsContainer.style.display = 'none';
                return;
            }
            
            let detailsHTML = '';
            
            switch(paymentMode) {
                case 'UPI':
                    detailsHTML = generateUPIDetails(amount);
                    break;
                case 'Bank Transfer':
                    detailsHTML = generateBankTransferDetails();
                    break;
                case 'Online':
                    detailsHTML = generateOnlinePaymentDetails(amount);
                    break;
                case 'Cash':
                    detailsHTML = generateCashDetails();
                    break;
                case 'Cheque':
                    detailsHTML = generateChequeDetails();
                    break;
                default:
                    paymentDetailsContainer.style.display = 'none';
                    return;
            }
            
            paymentDetailsContainer.innerHTML = detailsHTML;
            paymentDetailsContainer.style.display = 'block';
            
            // Generate QR codes after content is added to DOM
            setTimeout(() => {
                if (paymentMode === 'UPI' && amount) {
                    const upiUrl = `upi://pay?pa=hiteshsutharvfx@okhdfcbank&pn=${encodeURIComponent('Hitesh Suthar')}&am=${amount}&cu=INR&tn=${encodeURIComponent('Ganpati Donation')}`;
                    generateQRCode('upi-qr-code', upiUrl);
                }
                
                if (paymentMode === 'Online' && amount) {
                    const paymentUrl = `https://pay.google.com/gp/p/ui/pay?pa=hiteshsutharvfx@okhdfcbank&pn=Hitesh%20Suthar&am=${amount}&cu=INR&tn=Ganpati%20Donation`;
                    generateQRCode('online-qr-code', paymentUrl);
                }
            }, 100);
        }
        
        // Generate UPI payment details with QR code
        function generateUPIDetails(amount) {
            const upiId = 'hiteshsutharvfx@okhdfcbank';
            const upiName = 'Hitesh Suthar';
            const amountText = amount ? `‚Çπ${amount}` : 'Enter amount first';
            
            // Generate UPI URL for QR code
            const upiUrl = amount ?
                `upi://pay?pa=${upiId}&pn=${encodeURIComponent(upiName)}&am=${amount}&cu=INR&tn=${encodeURIComponent('Ganpati Donation')}` :
                `upi://pay?pa=${upiId}&pn=${encodeURIComponent(upiName)}&cu=INR&tn=${encodeURIComponent('Ganpati Donation')}`;
            
            return `
                <div class="payment-method-details upi-details">
                    <h4><i class="fas fa-mobile-alt"></i> UPI Payment Details</h4>
                    <div class="payment-info-grid">
                        <div class="payment-info-item">
                            <div class="payment-qr-section">
                                <div class="qr-code-container">
                                    <div id="upi-qr-code"></div>
                                    <p class="qr-label">Scan QR Code to Pay</p>
                                    ${amount ? `<p class="amount-display">Amount: ‚Çπ${amount}</p>` : '<p class="amount-warning">Please enter amount to generate QR</p>'}
                                </div>
                            </div>
                        </div>
                        <div class="payment-info-item">
                            <div class="payment-details-text">
                                <p><strong>UPI ID:</strong> <span class="copyable" onclick="copyToClipboard('${upiId}')">${upiId} <i class="fas fa-copy"></i></span></p>
                                <p><strong>Name:</strong> ${upiName}</p>
                                <p><strong>Amount:</strong> ${amountText}</p>
                                <div class="payment-instructions">
                                    <h5>Payment Instructions:</h5>
                                    <ol>
                                        <li>Open any UPI app (PhonePe, Google Pay, Paytm, etc.)</li>
                                        <li>Scan the QR code or use UPI ID: ${upiId}</li>
                                        <li>Enter amount: ${amountText}</li>
                                        <li>Complete the payment</li>
                                        <li>Take screenshot of payment confirmation</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Generate Bank Transfer details
        function generateBankTransferDetails() {
            return `
                <div class="payment-method-details bank-details">
                    <h4><i class="fas fa-university"></i> Bank Transfer Details</h4>
                    <div class="bank-info-grid">
                        <div class="bank-info-item">
                            <p><strong>Account Name:</strong> <span class="copyable" onclick="copyToClipboard('Ganpati Utsav Committee')">Ganpati Utsav Committee <i class="fas fa-copy"></i></span></p>
                            <p><strong>Account Number:</strong> <span class="copyable" onclick="copyToClipboard('1234567890123456')">1234567890123456 <i class="fas fa-copy"></i></span></p>
                            <p><strong>IFSC Code:</strong> <span class="copyable" onclick="copyToClipboard('SBIN0001234')">SBIN0001234 <i class="fas fa-copy"></i></span></p>
                            <p><strong>Bank Name:</strong> State Bank of India</p>
                            <p><strong>Branch:</strong> Main Branch, Mumbai</p>
                        </div>
                        <div class="bank-instructions">
                            <h5>Transfer Instructions:</h5>
                            <ol>
                                <li>Use the above bank details for NEFT/RTGS/IMPS transfer</li>
                                <li>Add "Ganpati Donation - [Your Name]" in remarks</li>
                                <li>Keep the transaction receipt</li>
                                <li>Share transaction ID after completing donation form</li>
                            </ol>
                            <div class="important-note">
                                <i class="fas fa-exclamation-triangle"></i>
                                <strong>Important:</strong> Please keep your transaction receipt safe for verification.
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Generate Online Payment details with QR code
        function generateOnlinePaymentDetails(amount) {
            const amountText = amount ? `‚Çπ${amount}` : 'Enter amount first';
            const paymentUrl = amount ?
                `https://pay.google.com/gp/p/ui/pay?pa=hiteshsutharvfx@okhdfcbank&pn=Hitesh%20Suthar&am=${amount}&cu=INR&tn=Ganpati%20Donation` :
                'https://pay.google.com/gp/p/ui/pay?pa=hiteshsutharvfx@okhdfcbank&pn=Hitesh%20Suthar&cu=INR&tn=Ganpati%20Donation';
            
            return `
                <div class="payment-method-details online-details">
                    <h4><i class="fas fa-globe"></i> Online Payment Details</h4>
                    <div class="online-payment-grid">
                        <div class="online-qr-section">
                            <div class="qr-code-container">
                                <div id="online-qr-code"></div>
                                <p class="qr-label">Scan for Online Payment</p>
                                ${amount ? `<p class="amount-display">Amount: ‚Çπ${amount}</p>` : '<p class="amount-warning">Please enter amount to generate payment QR</p>'}
                            </div>
                        </div>
                        <div class="online-payment-options">
                            <h5>Payment Options:</h5>
                            <div class="payment-buttons">
                                ${amount ? `
                                    <button type="button" class="payment-btn gpay-btn" onclick="openPaymentLink('gpay', ${amount})">
                                        <i class="fab fa-google-pay"></i> Google Pay
                                    </button>
                                    <button type="button" class="payment-btn phonepe-btn" onclick="openPaymentLink('phonepe', ${amount})">
                                        <i class="fas fa-mobile-alt"></i> PhonePe
                                    </button>
                                    <button type="button" class="payment-btn paytm-btn" onclick="openPaymentLink('paytm', ${amount})">
                                        <i class="fas fa-wallet"></i> Paytm
                                    </button>
                                ` : '<p class="amount-warning">Enter amount to enable payment buttons</p>'}
                            </div>
                            <div class="payment-instructions">
                                <h5>Instructions:</h5>
                                <ol>
                                    <li>Enter the donation amount first</li>
                                    <li>Scan QR code or click payment app buttons</li>
                                    <li>Complete payment in your preferred app</li>
                                    <li>Save payment confirmation</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Generate Cash payment details
        function generateCashDetails() {
            return `
                <div class="payment-method-details cash-details">
                    <h4><i class="fas fa-money-bill-wave"></i> Cash Payment Details</h4>
                    <div class="cash-info">
                        <div class="collection-points">
                            <h5>Collection Points:</h5>
                            <div class="collection-point">
                                <p><strong>Main Collection Center:</strong></p>
                                <p><i class="fas fa-map-marker-alt"></i> Ganpati Mandal Office, Building A, Ground Floor</p>
                                <p><i class="fas fa-clock"></i> Timing: 9:00 AM - 9:00 PM (Daily)</p>
                                <p><i class="fas fa-phone"></i> Contact: +91 98765 43210</p>
                            </div>
                            <div class="collection-point">
                                <p><strong>Volunteer Collection:</strong></p>
                                <p><i class="fas fa-users"></i> Our volunteers will visit each flat</p>
                                <p><i class="fas fa-calendar"></i> Collection Days: Weekends (Sat-Sun)</p>
                                <p><i class="fas fa-clock"></i> Timing: 10:00 AM - 6:00 PM</p>
                            </div>
                        </div>
                        <div class="cash-instructions">
                            <h5>Important Notes:</h5>
                            <ul>
                                <li>Please carry exact change if possible</li>
                                <li>You will receive a printed receipt immediately</li>
                                <li>Keep your receipt safe for records</li>
                                <li>For large amounts, please inform us in advance</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Generate Cheque payment details
        function generateChequeDetails() {
            return `
                <div class="payment-method-details cheque-details">
                    <h4><i class="fas fa-file-invoice"></i> Cheque Payment Details</h4>
                    <div class="cheque-info">
                        <div class="cheque-instructions">
                            <h5>Cheque Details:</h5>
                            <p><strong>Payable To:</strong> <span class="copyable" onclick="copyToClipboard('Ganpati Utsav Committee')">Ganpati Utsav Committee <i class="fas fa-copy"></i></span></p>
                            <p><strong>A/C Payee:</strong> Yes (Please cross the cheque)</p>
                            
                            <h5>Instructions:</h5>
                            <ol>
                                <li>Make cheque payable to "Ganpati Utsav Committee"</li>
                                <li>Cross the cheque and write "A/C Payee Only"</li>
                                <li>Write your name and contact number on the back</li>
                                <li>Submit cheque at collection center or to volunteers</li>
                                <li>Receipt will be provided after cheque clearance</li>
                            </ol>
                            
                            <div class="important-note">
                                <i class="fas fa-exclamation-triangle"></i>
                                <strong>Note:</strong> Cheque clearance may take 2-3 working days. Receipt will be generated after successful clearance.
                            </div>
                        </div>
                        
                        <div class="submission-details">
                            <h5>Submission Points:</h5>
                            <p><i class="fas fa-map-marker-alt"></i> Ganpati Mandal Office, Building A, Ground Floor</p>
                            <p><i class="fas fa-clock"></i> Timing: 9:00 AM - 6:00 PM (Mon-Sat)</p>
                            <p><i class="fas fa-phone"></i> Contact: +91 98765 43210</p>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Copy to clipboard function
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(function() {
                showMessage(`Copied: ${text}`, 'success');
            }).catch(function() {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showMessage(`Copied: ${text}`, 'success');
            });
        }
        
        // Open payment links for different apps
        function openPaymentLink(app, amount) {
            const upiId = 'hiteshsutharvfx@okhdfcbank';
            const name = encodeURIComponent('Hitesh Suthar');
            const note = encodeURIComponent('Ganpati Donation');
            
            let url = '';
            
            switch(app) {
                case 'gpay':
                    url = `tez://upi/pay?pa=${upiId}&pn=${name}&am=${amount}&cu=INR&tn=${note}`;
                    break;
                case 'phonepe':
                    url = `phonepe://pay?pa=${upiId}&pn=${name}&am=${amount}&cu=INR&tn=${note}`;
                    break;
                case 'paytm':
                    url = `paytmmp://pay?pa=${upiId}&pn=${name}&am=${amount}&cu=INR&tn=${note}`;
                    break;
            }
            
            // Try to open the app, fallback to web version
            window.location.href = url;
            
            // Fallback message
            setTimeout(() => {
                showMessage(`If ${app} didn't open, please use the QR code or UPI ID manually`, 'info');
            }, 2000);
        }
        
        // Generate QR codes using qrcode-generator library
        function generateQRCode(elementId, data) {
            const element = document.getElementById(elementId);
            if (element) {
                element.innerHTML = ''; // Clear previous QR code
                
                try {
                    // Check if qrcode library is available
                    if (window.qrcode) {
                        // Create QR code using qrcode-generator library
                        const qr = qrcode(0, 'M');
                        qr.addData(data);
                        qr.make();
                        
                        // Create QR code as SVG
                        const qrSvg = qr.createSvgTag(4, 0);
                        element.innerHTML = `
                            <div class="qr-container" style="display: flex; justify-content: center; align-items: center;">
                                ${qrSvg}
                            </div>
                        `;
                        
                        // Style the SVG
                        const svg = element.querySelector('svg');
                        if (svg) {
                            svg.style.width = '200px';
                            svg.style.height = '200px';
                            svg.style.border = '1px solid #ddd';
                            svg.style.borderRadius = '8px';
                            svg.style.backgroundColor = 'white';
                        }
                    } else {
                        throw new Error('QR library not available');
                    }
                } catch (error) {
                    console.error('QR Code generation error:', error);
                    // Fallback: Use online QR generator
                    const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(data)}`;
                    element.innerHTML = `
                        <div class="qr-container">
                            <img src="${qrUrl}" alt="QR Code" style="width: 200px; height: 200px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border: 1px solid #ddd;"
                                 onerror="this.parentElement.innerHTML='<div class=\\"qr-fallback\\"><i class=\\"fas fa-qrcode\\" style=\\"font-size: 100px; color: #ccc;\\"></i><p>QR Code unavailable</p><small>Please use UPI ID: hiteshsutharvfx@okhdfcbank</small></div>'" />
                        </div>
                    `;
                }
            }
        }
        
        // Update QR codes when amount changes
        function updatePaymentQRCodes() {
            const paymentMode = document.getElementById('paymentMode').value;
            const amount = document.getElementById('amount').value;
            
            if (paymentMode && amount) {
                if (paymentMode === 'UPI' && document.getElementById('upi-qr-code')) {
                    const upiUrl = `upi://pay?pa=hiteshsutharvfx@okhdfcbank&pn=${encodeURIComponent('Hitesh Suthar')}&am=${amount}&cu=INR&tn=${encodeURIComponent('Ganpati Donation')}`;
                    generateQRCode('upi-qr-code', upiUrl);
                }
                
                if (paymentMode === 'Online' && document.getElementById('online-qr-code')) {
                    const paymentUrl = `https://pay.google.com/gp/p/ui/pay?pa=hiteshsutharvfx@okhdfcbank&pn=Hitesh%20Suthar&am=${amount}&cu=INR&tn=Ganpati%20Donation`;
                    generateQRCode('online-qr-code', paymentUrl);
                }
                
                // Refresh payment details to update amount display
                showPaymentDetails();
            }
        }
        
        // Display donations table and refresh functions
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-refresh every 5 seconds
            setInterval(refreshDonationsTable, 5000);
            
            // Add event listener to amount field to update QR codes
            const amountField = document.getElementById('amount');
            if (amountField) {
                amountField.addEventListener('input', updatePaymentQRCodes);
                amountField.addEventListener('change', updatePaymentQRCodes);
            }
            
            // Debug: Check if QR library is loaded
            console.log('qrcode library available:', typeof window.qrcode !== 'undefined');
            if (window.qrcode) {
                console.log('qrcode function available');
            }
        });
        
        // Refresh donations table
        function refreshDonationsTable() {
            const currentDonations = window.donations || [];
            const tableBody = document.getElementById('donations-table-body');
            
            if (currentDonations.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="8" class="text-center">No donations recorded yet</td></tr>';
                return;
            }
            
            tableBody.innerHTML = currentDonations.map((donation, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${donation.name}</td>
                    <td>${donation.flatDisplay || 'N/A'}</td>
                    <td>‚Çπ${parseFloat(donation.amount).toLocaleString('en-IN')}</td>
                    <td>${donation.paymentMode}</td>
                    <td>${donation.date}</td>
                    <td>${donation.id}</td>
                    <td>
                        <button onclick="deleteDonation('${donation.id || donation.donationId}')"
                                class="btn btn-sm btn-danger"
                                title="Delete this donation"
                                style="background: #dc3545; color: white; border: none; padding: 0.4rem 0.8rem; border-radius: 6px; cursor: pointer; font-size: 0.8rem; transition: all 0.3s ease;">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </td>
                </tr>
            `).join('');
        }
        
        // Display recent donations list (kept for compatibility)
        function displayRecentDonationsList() {
            refreshDonationsTable();
        }
        
        // Excel Integration Functions
        async function exportToExcel() {
            try {
                const result = await window.donationAPI.exportToExcel();
                if (result.success) {
                    showMessage('Donations exported to Excel successfully!', 'success');
                } else {
                    showMessage(`Export failed: ${result.error}`, 'error');
                }
            } catch (error) {
                showMessage(`Export error: ${error.message}`, 'error');
            }
        }
        
        async function importFromExcel(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            try {
                const result = await window.donationAPI.loadFromExcel(file);
                if (result.success) {
                    // Update global donations array
                    window.donations = result.data;
                    
                    // Refresh the table
                    refreshDonationsTable();
                    updateAnalytics();
                    
                    showMessage(`Successfully imported ${result.imported} new donations! Total: ${result.total}`, 'success');
                    
                    // Update status
                    document.getElementById('excel-status').innerHTML =
                        `<p><i class="fas fa-check-circle"></i> Imported ${result.imported} new donations from ${file.name}. Total donations: ${result.total}</p>`;
                } else {
                    showMessage(`Import failed: ${result.error}`, 'error');
                }
            } catch (error) {
                showMessage(`Import error: ${error.message}`, 'error');
            }
            
            // Reset file input
            event.target.value = '';
        }
        
        function downloadExcelTemplate() {
            // Create a template Excel file with headers
            const templateData = [{
                'Donation ID': 'GP1234567890123ABC',
                'Date': '2024-01-01',
                'Name': 'Sample Donor',
                'Email': 'donor@example.com',
                'Phone': '+91 98765 43210',
                'Wing': 'A',
                'Floor': 3,
                'Flat': '302',
                'Address': 'Wing A - 302',
                'Amount': 1001,
                'Payment Mode': 'UPI',
                'Note': 'Sample donation',
                'Status': 'confirmed',
                'Timestamp': new Date().toISOString()
            }];
            
            const workbook = XLSX.utils.book_new();
            const worksheet = XLSX.utils.json_to_sheet(templateData);
            
            // Auto-size columns
            const colWidths = [
                { wch: 20 }, { wch: 12 }, { wch: 20 }, { wch: 25 }, { wch: 15 },
                { wch: 8 }, { wch: 8 }, { wch: 12 }, { wch: 25 }, { wch: 12 },
                { wch: 15 }, { wch: 30 }, { wch: 12 }, { wch: 20 }
            ];
            worksheet['!cols'] = colWidths;
            
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Donations');
            XLSX.writeFile(workbook, 'Ganpati_Donations_Template.xlsx');
            
            showMessage('Excel template downloaded successfully!', 'success');
        }
        
        // Show message function (if not already defined)
        function showMessage(message, type = 'info') {
            // Remove existing messages
            const existingMessages = document.querySelectorAll('.message');
            existingMessages.forEach(msg => msg.remove());
            
            // Create message element
            const messageEl = document.createElement('div');
            messageEl.className = `message ${type}`;
            messageEl.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#17a2b8'};
                color: white;
                padding: 1rem 2rem;
                border-radius: 5px;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            messageEl.textContent = message;
            
            // Add to page
            document.body.appendChild(messageEl);
            
            // Remove after 5 seconds
            setTimeout(() => {
                messageEl.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => messageEl.remove(), 300);
            }, 5000);
        }
        
        // Delete donation function
        function deleteDonation(donationId) {
            if (!donationId) {
                showMessage('Invalid donation ID', 'error');
                return;
            }
            
            // Show confirmation dialog
            const donationToDelete = window.donations.find(d => d.id === donationId || d.donationId === donationId);
            if (!donationToDelete) {
                showMessage('Donation not found', 'error');
                return;
            }
            
            const confirmMessage = `Are you sure you want to delete this donation?\n\nDonor: ${donationToDelete.name}\nAmount: ‚Çπ${parseFloat(donationToDelete.amount).toLocaleString('en-IN')}\nDate: ${donationToDelete.date}\n\nThis action cannot be undone.`;
            
            if (confirm(confirmMessage)) {
                try {
                    // Remove from global donations array
                    const initialLength = window.donations.length;
                    window.donations = window.donations.filter(d => (d.id !== donationId && d.donationId !== donationId));
                    
                    if (window.donations.length < initialLength) {
                        // Update localStorage to persist the change
                        localStorage.setItem('ganpati_excel_data', JSON.stringify(window.donations));
                        
                        // Refresh the table
                        refreshDonationsTable();
                        
                        // Update analytics if available
                        if (typeof updateAnalytics === 'function') {
                            updateAnalytics();
                        }
                        
                        // Show success message
                        showMessage(`Donation by ${donationToDelete.name} (‚Çπ${parseFloat(donationToDelete.amount).toLocaleString('en-IN')}) has been deleted successfully.`, 'success');
                        
                        // Log the deletion for audit purposes
                        console.log(`Donation deleted: ID=${donationId}, Name=${donationToDelete.name}, Amount=${donationToDelete.amount}, Date=${donationToDelete.date}`);
                        
                    } else {
                        showMessage('Failed to delete donation. Please try again.', 'error');
                    }
                } catch (error) {
                    console.error('Error deleting donation:', error);
                    showMessage(`Error deleting donation: ${error.message}`, 'error');
                }
            }
        }
    </script>

    <style>
        .donation-info {
            margin-bottom: 3rem;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .section-actions {
            display: flex;
            gap: 1rem;
        }
        
        /* Form Section Styles */
        .form-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-left: 4px solid #ff6b35;
        }
        
        .section-title {
            color: #ff6b35;
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .field-help {
            display: block;
            color: #666;
            font-size: 0.85rem;
            margin-top: 0.25rem;
            font-style: italic;
        }
        
        .optional {
            color: #28a745;
            font-weight: normal;
            font-size: 0.9rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #ff6b35;
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }
        
        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: #999;
            font-style: italic;
        }
        
        /* Required field indicator */
        .form-group label:has(+ input[required])::after,
        .form-group label:has(+ select[required])::after {
            content: " *";
            color: #dc3545;
        }
        
        /* Live Database Table Styles */
        .table-container {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin: 2rem 0;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th,
        .table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .table th {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            font-weight: 600;
        }
        
        .table tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        .text-center {
            text-align: center;
        }
        
        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(220, 53, 69, 0.3);
        }
        
        .btn-danger:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(220, 53, 69, 0.3);
        }
        
        .btn-danger i {
            font-size: 0.7rem;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .info-item {
            text-align: center;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 10px;
            border-top: 4px solid #ff6b35;
        }
        
        .info-item i {
            font-size: 2.5rem;
            color: #ff6b35;
            margin-bottom: 1rem;
        }
        
        .info-item h3 {
            margin-bottom: 1rem;
            color: #333;
        }
        
        .donation-form-section {
            margin-bottom: 3rem;
        }
        
        .quick-amounts {
            margin: 2rem 0;
        }
        
        .quick-amounts label {
            display: block;
            margin-bottom: 1rem;
            font-weight: 600;
            color: #333;
        }
        
        .amount-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .amount-btn {
            padding: 0.75rem 1.5rem;
            border: 2px solid #ff6b35;
            background: white;
            color: #ff6b35;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .amount-btn:hover {
            background: #ff6b35;
            color: white;
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }
        
        .payment-info {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin: 3rem 0;
        }
        
        .payment-methods {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .payment-method {
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #ff6b35;
        }
        
        .payment-method h3 {
            color: #ff6b35;
            margin-bottom: 1rem;
        }
        
        .payment-method p {
            margin-bottom: 0.5rem;
            color: #666;
        }
        
        .recent-donations-section {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin: 3rem 0;
        }
        
        .donations-list {
            margin-top: 2rem;
        }
        
        .donation-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid #ff6b35;
        }
        
        .donor-info h4 {
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .donation-amount {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ff6b35;
        }
        
        .donation-details p {
            margin-bottom: 0.25rem;
            color: #666;
            font-size: 0.9rem;
        }
        
        .donation-details i {
            margin-right: 0.5rem;
            color: #ff6b35;
        }
        
        @media (max-width: 768px) {
            .donation-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .amount-buttons {
                justify-content: center;
            }
            
            .form-actions {
                flex-direction: column;
            }
/* Excel Integration Styles */
        .excel-integration-section {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin: 3rem 0;
            border-left: 4px solid #28a745;
        }
        
        .excel-integration-section h2 {
            color: #28a745;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .excel-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }
        
        .excel-upload label {
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .excel-status {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #17a2b8;
        }
        
        .excel-status p {
            margin: 0;
            color: #666;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .excel-status i {
            color: #17a2b8;
        }
        
        .btn-info {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-info:hover {
            background: #138496;
            transform: translateY(-2px);
        }
        
        /* Payment Details Styles */
        .payment-details-container {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #28a745;
        }
        
        .payment-method-details {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .payment-method-details h4 {
            color: #28a745;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* UPI Details Styles */
        .payment-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: start;
        }
        
        .qr-code-container {
            text-align: center;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px dashed #28a745;
        }
        
        .qr-code-container canvas {
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .qr-label {
            margin: 1rem 0 0.5rem 0;
            font-weight: 600;
            color: #333;
        }
        
        .amount-display {
            font-size: 1.2rem;
            font-weight: bold;
            color: #28a745;
            margin: 0.5rem 0;
        }
        
        .amount-warning {
            color: #dc3545;
            font-weight: 600;
            margin: 0.5rem 0;
        }
        
        .payment-details-text p {
            margin-bottom: 0.75rem;
            color: #333;
        }
        
        .copyable {
            background: #e9ecef;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .copyable:hover {
            background: #28a745;
            color: white;
        }
        
        .payment-instructions {
            margin-top: 1.5rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #17a2b8;
        }
        
        .payment-instructions h5 {
            color: #17a2b8;
            margin-bottom: 1rem;
        }
        
        .payment-instructions ol {
            margin: 0;
            padding-left: 1.5rem;
        }
        
        .payment-instructions li {
            margin-bottom: 0.5rem;
            color: #666;
        }
        
        /* Bank Transfer Styles */
        .bank-info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .bank-info-item p {
            margin-bottom: 0.75rem;
            color: #333;
        }
        
        .bank-instructions {
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .important-note {
            margin-top: 1rem;
            padding: 1rem;
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            color: #856404;
        }
        
        /* Online Payment Styles */
        .online-payment-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .payment-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .payment-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            justify-content: center;
        }
        
        .gpay-btn {
            background: #4285f4;
            color: white;
        }
        
        .gpay-btn:hover {
            background: #3367d6;
            transform: translateY(-2px);
        }
        
        .phonepe-btn {
            background: #5f259f;
            color: white;
        }
        
        .phonepe-btn:hover {
            background: #4a1d7a;
            transform: translateY(-2px);
        }
        
        .paytm-btn {
            background: #00baf2;
            color: white;
        }
        
        .paytm-btn:hover {
            background: #0095c7;
            transform: translateY(-2px);
        }
        
        /* Cash Payment Styles */
        .cash-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .collection-points {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
        }
        
        .collection-point {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #ff6b35;
        }
        
        .collection-point p {
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        .cash-instructions {
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .cash-instructions h5 {
            color: #ff6b35;
            margin-bottom: 1rem;
        }
        
        .cash-instructions ul {
            margin: 0;
            padding-left: 1.5rem;
        }
        
        .cash-instructions li {
            margin-bottom: 0.5rem;
            color: #666;
        }
        
        /* Cheque Payment Styles */
        .cheque-info {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }
        
        .cheque-instructions {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
        }
        
        .submission-details {
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #17a2b8;
        }
        
        .submission-details h5 {
            color: #17a2b8;
            margin-bottom: 1rem;
        }
        
        .submission-details p {
            margin-bottom: 0.5rem;
            color: #333;
        }
        
        /* QR Fallback Styles */
        .qr-fallback {
            text-align: center;
            padding: 2rem;
            color: #666;
        }
        
        .qr-fallback p {
            margin: 1rem 0 0.5rem 0;
            font-weight: 600;
        }
        
        .qr-fallback small {
            color: #999;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .payment-info-grid,
            .bank-info-grid,
            .online-payment-grid,
            .cash-info,
            .cheque-info {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .payment-buttons {
                flex-direction: column;
            }
            
            .collection-points,
            .cash-instructions,
            .cheque-instructions,
            .submission-details {
                padding: 1rem;
            }
        }
    </style>
    <!-- Firebase SDK v10 (Modern) -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        // Make Firebase available globally for our scripts
        window.firebaseModules = {
            initializeApp,
            getFirestore
        };
        
        console.log('Firebase modules loaded');
    </script>
    
    <!-- Firebase Configuration and Integration -->
    <script src="js/firebase-config.js"></script>
    <script src="js/firebase-donation-api.js"></script>
    <script src="js/mail.js"></script>
</body>
</html>